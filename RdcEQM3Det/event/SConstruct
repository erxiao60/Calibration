'''
 *  $Id: SConstruct, 2014-08-08 01:07:55 DAMPE $
 *----------------------------------------------------------
 *  This file is automatically generated by dmpNewEvt
 *----------------------------------------------------------
 *  1. create a shared library
 *  2. install it into $DMPSWWORK
 *  then, in your JobOpt* file could use your Evt.
 *----------------------------------------------------------
'''

import os

target='DmpEventRaw'

print "---> compiling: %s\n" % target
#--------------------------------------------------------------------
# environment
env = Environment(ENV = os.environ)
#env.ParseConfig("dmpsw-config --include --libs")
#env.ParseConfig("python-config --include --libs")  # 2 lines for binding
#env.Append(LIBS=['boost_python'])
env.ParseConfig("root-config --cflags --libs")

#-------------------------------------------------------------------
# include dir. and external libs
includeDir='./include'
env.Prepend(CPPPATH=[includeDir])

# installation
#--------------------------------------------------------------------
for tmp in os.listdir(includeDir):
    if "." not in tmp[0] and "LinkDef" not in tmp and "Dictionary" not in tmp and ".h" in tmp:
        Default(Command(os.environ['DMPSWWORK']+'/include/'+tmp,includeDir+'/'+tmp,Copy("$TARGET","$SOURCE")))

#-------------------------------------------------------------------
# main build
goal=env.SharedLibrary(target,Glob('./src/*.cc'))
Default(env.InstallAs(os.environ['DMPSWWORK']+'/lib/lib'+target+".so",goal))

